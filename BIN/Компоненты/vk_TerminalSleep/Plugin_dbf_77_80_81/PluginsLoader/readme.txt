Загрузчик требуется для подключения плагинов к 1С:Предприятие 7.7, 8.0 или 8.1.
Плагины представляют собой DLL, которые расположены в папке BIN\Plugins каталога
программных файлов 1С:Предприятие.
Загрузчик поддерживает файл INI, чтобы иметь возможность управлять загрузкой плагинов,
не отключая пользователей от 1С:Предприятие.
Если файл INI пустой, или все строчки в нем закомментированы, то загрузка плагинов не производится.


Установка



Для установки необходимо скопировать файлы hook_1c.dll и patch_hook_1c.exe в папку 1cv77\bin, 1cv8\bin или 1cv81\bin, 
в зависимости от версии 1С:Предприятие, а затем запустить программу patch_hook_1c.exe.

Программа спросит, хотите ли пропатчить DLL - нажмите ОК.

У вас должны быть права на доступ к файлам 1С:Предприятие. Все копии 1С:Предприятие должны быть закрыты
(иначе система не позволяет вносить в них изменения).

Успешно установленный загрузчик потребует наличие директории Plugins внутри папки Bin, и файла Hook_1C.ini внутри папки Bin\Plugins.

Создайте эту директорию, и этот файл (например, при помощи программы Блокнот).

Файл Hook_1C.ini может быть пустым, а может содержать строки вида:

LoadDll=ИмяПапки1\ИмяDll_1.dll
LoadDll=ИмяПапки2\ИмяDll_2.dll

Символ ; внутри этого файла начинает комментарий до конца строки.
Удобно пользоваться этим символом, чтобы временно "закомментировать" загрузку каких-то (или всех) dll.

Пути к плагинам подразумеваются относительно папки Bin\Plugins, то есть, например,

Bin\Plugins\ИмяПапки1\ИмяDll_1.dll



Удаление

Для удаления загрузчика необходимо переустановить 1С:Предприятие, или восстановить файл seven.dll из 
резервной копии seven.dll.bak (для версии 7.7) или frntend.dll из резервной копии frntend.dll.bak 
(для версии 8.x).



Исходный код

Исходный код (компилятор - Delphi 6) содержится в файлах с расширениями DPR настоящего дистрибутива.
Для компиляции должна подойти также версия компилятора Delphi 7.



(с) romix, 2007  x-romix@mail.ru, ICQ 217099805


14.12.2007 - исправлена ошибка установщика, которая возникала в более новых версиях 8.1, например 8.1.8.76

18.08.2010 - исправлена ошибка для 8.1 (не запускались команды наподобие ЗапуститьПриложение("D:\Temp81\1.xls");)